# üß≠ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–º–µ–Ω–∏ —Å–µ—Ä–≤–µ—Ä–∞ (mDNS) –∏ –∑–∞–ø—É—Å–∫ CRM –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è IP

> –¶–µ–ª—å: —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä –Ω–∞ Ubuntu (–≤–æ –í–ú VirtualBox) –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω **–ø–æ –∏–º–µ–Ω–∏**,  
> –Ω–∞–ø—Ä–∏–º–µ—Ä:  
> `http://erpserver.local`  
> –≤–º–µ—Å—Ç–æ IP-–∞–¥—Ä–µ—Å–∞ (`http://192.168.x.x:8000`)

---

## ‚öôÔ∏è 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã

1. –í VirtualBox –æ—Ç–∫—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–≤–æ–µ–π –í–ú (**Settings ‚Üí Network**).  
2. –£—Å—Ç–∞–Ω–æ–≤–∏:
   - **Attached to:** `Bridged Adapter`  
   - **Adapter Type:** `Intel PRO/1000 MT Desktop (82540EM)`  
   - **Promiscuous Mode:** `Deny`  
   - **Virtual Cable Connected:** ‚òëÔ∏è –≤–∫–ª—é—á–µ–Ω–æ  
3. –°–æ—Ö—Ä–∞–Ω–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

> ‚ö° –†–µ–∂–∏–º Bridge –¥–µ–ª–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª–∫—É –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–º –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏,  
> –∏ –æ–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç IP –Ω–∞—Ä–∞–≤–Ω–µ —Å –¥—Ä—É–≥–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏.

---

## üß© 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ IP-–∞–¥—Ä–µ—Å–∞

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –í–ú –≤—ã–ø–æ–ª–Ω–∏:
```bash
ip a
```
–î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —Å—Ç—Ä–æ–∫–∞ —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º `enp0s3` –∏ IP –≤–∏–¥–∞:
```
inet 192.168.1.30/24 ...
```

–ï—Å–ª–∏ IP –∏–∑ —Ç–≤–æ–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ ‚Äî –≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ.

---

## üåç 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–µ—Ä–∫–∞–ª (APT) –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Avahi

–§–∞–π–ª `fix_mirror_and_avahi.sh` –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –≤—Å—ë:
- –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç APT –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∑–µ—Ä–∫–∞–ª–∞ (`archive.ubuntu.com`);
- –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏;
- —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `avahi-daemon`, `avahi-utils`, `libnss-mdns`;
- –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç hostname;
- –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç—ã;
- –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Å–ª—É–∂–±—É Avahi.

### üìÑ –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞

1. –°–∫–æ–ø–∏—Ä—É–π —Ñ–∞–π–ª `fix_mirror_and_avahi.sh` –≤ Shared Folder.  
2. –í Ubuntu-–í–ú:
   ```bash
   cd /media/sf_Shared_VM
   sudo chmod +x fix_mirror_and_avahi.sh
   sed -i 's/\r$//' fix_mirror_and_avahi.sh   # —É–±–∏—Ä–∞–µ–º Windows-—Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ –Ω–∞–¥–æ
   sudo ./fix_mirror_and_avahi.sh erpserver 8000
   ```

3. –í –∫–æ–Ω—Ü–µ —Ç—ã —É–≤–∏–¥–∏—à—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
   ```
   [INFO] –ì–û–¢–û–í–û ‚úÖ  –û—Ç–∫—Ä—ã–≤–∞–π —Å –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ —Å–µ—Ç–∏:
   http://erpserver.local:8000
   ```

---

## üîÅ 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∏–º–µ–Ω–∏ (mDNS)

–ü—Ä–æ–≤–µ—Ä—å –ø—Ä—è–º–æ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –í–ú:
```bash
avahi-resolve-host-name erpserver.local
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
erpserver.local   192.168.1.30
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å –æ—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–Ω–∞ –ª—é–±–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –≤ —Å–µ—Ç–∏):

üëâ `http://erpserver.local:8000`

---

## üß± 5. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –°–¥–µ–ª–∞—Ç—å –¥–æ—Å—Ç—É–ø –±–µ–∑ –ø–æ—Ä—Ç–∞

–ß—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞–ª—Å—è –ø—Ä–æ—Å—Ç–æ –ø–æ –∞–¥—Ä–µ—Å—É `http://erpserver.local`,  
–Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Nginx –∫–∞–∫ —Ä–µ–≤–µ—Ä—Å-–ø—Ä–æ–∫—Å–∏:

```bash
sudo apt install -y nginx
sudo tee /etc/nginx/sites-available/erpserver >/dev/null <<'EOF'
server {
    listen 80;
    server_name erpserver.local;
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
EOF

sudo ln -s /etc/nginx/sites-available/erpserver /etc/nginx/sites-enabled/
sudo nginx -t && sudo systemctl reload nginx
sudo ufw allow 80/tcp
```

–¢–µ–ø–µ—Ä—å —Å–∞–π—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –ø–æ—Ä—Ç–∞:
```
http://erpserver.local
```

---

## ‚öôÔ∏è 6. –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (systemd)

–ß—Ç–æ–±—ã CRM —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è –í–ú,  
—Å–æ–∑–¥–∞–π —Å–µ—Ä–≤–∏—Å `/etc/systemd/system/erp.service`:

```bash
sudo tee /etc/systemd/system/erp.service >/dev/null <<'EOF'
[Unit]
Description=ERP Web Application
After=network.target

[Service]
User=admin_erp
WorkingDirectory=/home/admin_erp/erp
ExecStart=/home/admin_erp/.venv/bin/python app.py
Restart=always

[Install]
WantedBy=multi-user.target
EOF

sudo systemctl daemon-reload
sudo systemctl enable --now erp
```

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
```bash
systemctl status erp
```

---

## üß† 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

üì± **–° –ü–ö, –Ω–æ—É—Ç–±—É–∫–∞ –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞**, –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ –∫ —Ç–æ–π –∂–µ Wi-Fi —Å–µ—Ç–∏,  
–≤–≤–µ–¥–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

```
http://erpserver.local
```

–ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è ‚Äî –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç! üéâ

> ‚ö†Ô∏è –í —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö Android –∏–ª–∏ –≥–æ—Å—Ç–µ–≤—ã—Ö Wi-Fi)
> mDNS –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –¢–æ–≥–¥–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π DNS
> –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ (A-–∑–∞–ø–∏—Å—å `erpserver.lan ‚Üí 192.168.1.30`).

---

## üíæ 8. –ß—Ç–æ —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –í–ú

1. –í–ú –ø–æ–ª—É—á–∞–µ—Ç IP –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ (Bridge).  
2. –°–ª—É–∂–±–∞ `avahi-daemon` —Å—Ç–∞—Ä—Ç—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.  
3. –ò–º—è `erpserver.local` –æ–±—ä—è–≤–ª—è–µ—Ç—Å—è –ø–æ —Å–µ—Ç–∏.  
4. Flask/Nginx –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `systemd`.  
5. –õ—é–±–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ —Å–µ—Ç–∏ –≤–∏–¥–∏—Ç —Å–µ—Ä–≤–µ—Ä –ø–æ –∏–º–µ–Ω–∏ ‚Äî –±–µ–∑ IP.

---

## üß© –†–µ–∑—é–º–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|------------|-------------|---------|
| **Bridge Adapter** | –¥–æ—Å—Ç—É–ø –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ | ‚úÖ |
| **Avahi (mDNS)** | –∏–º—è `erpserver.local` | ‚úÖ |
| **UFW –ø–æ—Ä—Ç—ã (5353/udp, 80/tcp)** | —Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø | ‚úÖ |
| **Nginx-–ø—Ä–æ–∫—Å–∏** | —É–±–∏—Ä–∞–µ—Ç `:8000` | ‚úÖ |
| **Systemd-—Å–µ—Ä–≤–∏—Å** | –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ CRM | ‚úÖ |

---

## üöÄ –§–∏–Ω–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø

**–° –ª—é–±–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Å–µ—Ç–∏:**

```
http://erpserver.local
```
